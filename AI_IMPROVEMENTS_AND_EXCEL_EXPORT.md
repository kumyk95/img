# –£–ª—É—á—à–µ–Ω–∏—è –∫–∞—á–µ—Å—Ç–≤–∞ –∏ —ç–∫—Å–ø–æ—Ä—Ç –≤ Excel

## ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

### –ß–∞—Å—Ç—å 1: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è AI –º–æ–¥–µ–ª–∏

#### 1.1 –£–≤–µ–ª–∏—á–µ–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç PCA (50 ‚Üí 100)

**–§–∞–π–ª**: `/root/site-img/backend/ai_service.py`

**–ò–∑–º–µ–Ω–µ–Ω–∏–µ**:
```python
# –ë—ã–ª–æ:
max_comp = min(len(images) - 1, 50)

# –°—Ç–∞–ª–æ:
max_comp = min(len(images) - 1, 100)
```

**–≠—Ñ—Ñ–µ–∫—Ç**: –ú–æ–¥–µ–ª—å –º–æ–∂–µ—Ç –∑–∞—Ö–≤–∞—Ç–∏—Ç—å –±–æ–ª—å—à–µ –¥–µ—Ç–∞–ª–µ–π –ª–∏—Ü–∞, —É–ª—É—á—à–∞—è –∫–∞—á–µ—Å—Ç–≤–æ —Ä–µ–∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏.

---

#### 1.2 –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ PCA –∫–∞–∂–¥—ã–µ 50 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

**–§–∞–π–ª**: `/root/site-img/backend/ai_service.py`

**–î–æ–±–∞–≤–ª–µ–Ω–æ**:
- –°—á–µ—Ç—á–∏–∫ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π: `self.images_processed = 0`
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ –≤ `process_reconstruction()`:

```python
def process_reconstruction(self, image_path, original_path, method_id):
    # Auto-retrain PCA model every 50 images for continuous improvement
    self.images_processed += 1
    if self.images_processed % 50 == 0:
        print(f"Auto-retraining PCA model after {self.images_processed} images...")
        self.train_pca_model()
```

**–≠—Ñ—Ñ–µ–∫—Ç**: 
- –ü—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ 10000 —Ñ–æ—Ç–æ –º–æ–¥–µ–ª—å –ø–µ—Ä–µ–æ–±—É—á–∏—Ç—Å—è **200 —Ä–∞–∑**
- –ö–∞–∂–¥–æ–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –±–æ–ª—å—à–µ –¥–∞–Ω–Ω—ã—Ö ‚Üí –∫–∞—á–µ—Å—Ç–≤–æ —É–ª—É—á—à–∞–µ—Ç—Å—è
- –ù–∞–ø—Ä–∏–º–µ—Ä:
  - –ü–æ—Å–ª–µ 50 —Ñ–æ—Ç–æ: –º–æ–¥–µ–ª—å –æ–±—É—á–µ–Ω–∞ –Ω–∞ ~50 –ª–∏—Ü–∞—Ö
  - –ü–æ—Å–ª–µ 100 —Ñ–æ—Ç–æ: –º–æ–¥–µ–ª—å –æ–±—É—á–µ–Ω–∞ –Ω–∞ ~100 –ª–∏—Ü–∞—Ö (–º–∞–∫—Å–∏–º—É–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç)
  - –ü–æ—Å–ª–µ 1000 —Ñ–æ—Ç–æ: –º–æ–¥–µ–ª—å –æ–±—É—á–µ–Ω–∞ –Ω–∞ ~100 –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –ª–∏—Ü–∞—Ö (cleanup —É–¥–∞–ª—è–µ—Ç —Å—Ç–∞—Ä—ã–µ)

---

#### 1.3 –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è Hybrid –º–µ—Ç–æ–¥–∞

**–§–∞–π–ª**: `/root/site-img/backend/ai_service.py`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è**:

1. **–ò–∑–º–µ–Ω–µ–Ω–æ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ blending: 60/40 ‚Üí 70/30**
```python
# –ë—ã–ª–æ:
mixed = hybrid_img.astype(float) * 0.6 + inpainted.astype(float) * 0.4

# –°—Ç–∞–ª–æ:
mixed = hybrid_img.astype(float) * 0.7 + inpainted.astype(float) * 0.3
```

**–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ**: PCA –ø–æ–∫–∞–∑–∞–ª score **0.9661** (–æ—Ç–ª–∏—á–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç–∏), –ø–æ—ç—Ç–æ–º—É —É–≤–µ–ª–∏—á–∏–ª–∏ –µ–≥–æ –≤–µ—Å.

2. **–î–æ–±–∞–≤–ª–µ–Ω–æ —Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏–µ –º–∞—Å–∫–∏**
```python
# Smooth the mask for better blending
mask_3c_smooth = cv2.GaussianBlur(mask_3c, (5, 5), 2)
```

**–≠—Ñ—Ñ–µ–∫—Ç**: –ë–æ–ª–µ–µ –ø–ª–∞–≤–Ω—ã–µ –ø–µ—Ä–µ—Ö–æ–¥—ã –Ω–∞ –≥—Ä–∞–Ω–∏—Ü–∞—Ö –º–∞—Å–∫–∏, –º–µ–Ω—å—à–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤.

---

### –ß–∞—Å—Ç—å 2: –≠–∫—Å–ø–æ—Ä—Ç –≤ Excel

#### 2.1 –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ xlsx

```bash
npm install xlsx --save
```

#### 2.2 –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ batch results

**–§–∞–π–ª**: `/root/site-img/src/app/simulation.service.ts`

**–î–æ–±–∞–≤–ª–µ–Ω–æ**:

1. **–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å BatchResult**:
```typescript
export interface BatchResult {
    imageIndex: number;
    fileName: string;
    sessionId: string;
    timestamp: Date;
    steps: SimulationStep[];
}
```

2. **–•—Ä–∞–Ω–∏–ª–∏—â–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤**:
```typescript
private batchResults: BatchResult[] = [];
private currentImageIndex: number = 0;
private currentFileName: string = '';
```

3. **–ú–µ—Ç–æ–¥—ã –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è**:
- `setCurrentImageIndex(index: number)` - —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç–µ–∫—É—â–∏–π –∏–Ω–¥–µ–∫—Å
- `clearBatchResults()` - –æ—á–∏—Å—Ç–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–µ—Ä–µ–¥ –Ω–æ–≤—ã–º batch
- `saveBatchResult()` - —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ–∫—É—â–µ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
- `exportBatchToExcel()` - —ç–∫—Å–ø–æ—Ä—Ç –≤ Excel

---

#### 2.3 –§–æ—Ä–º–∞—Ç Excel —Ñ–∞–π–ª–∞

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞**:

| –°—Ç–æ–ª–±–µ—Ü | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| Image # | –ù–æ–º–µ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (1, 2, 3...) |
| File Name | –ò–º—è —Ñ–∞–π–ª–∞ |
| Session ID | UUID —Å–µ—Å—Å–∏–∏ |
| Timestamp | –î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ |
| Original_Status | –°—Ç–∞—Ç—É—Å —ç—Ç–∞–ø–∞ Original |
| Glasses_Status | –°—Ç–∞—Ç—É—Å —ç—Ç–∞–ø–∞ With Glasses |
| Glasses_Score | Recognition score |
| Glasses_ProcTime(ms) | –í—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ (–º—Å) |
| Glasses_RecTime(ms) | –í—Ä–µ–º—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è (–º—Å) |
| Inpainting_Status | –°—Ç–∞—Ç—É—Å —ç—Ç–∞–ø–∞ Inpainting |
| Inpainting_Score | Recognition score |
| ... | ... (–∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ –¥–ª—è CNN, GAN, Hybrid) |

**–ü—Ä–∏–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö**:

```
Image # | File Name    | Session ID | Timestamp           | ... | Hybrid_Score | Hybrid_ProcTime(ms)
1       | photo001.jpg | abc-123... | 2026-02-10 01:30:00 | ... | 0.9661       | 23
2       | photo002.jpg | def-456... | 2026-02-10 01:30:15 | ... | 0.9723       | 22
3       | photo003.jpg | ghi-789... | 2026-02-10 01:30:30 | ... | 0.9589       | 24
```

---

#### 2.4 –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ñ–æ—Ä–º–∞—Ç–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞

```typescript
exportData() {
    if (this.batchResults.length === 0) {
        // –û–¥–Ω–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ ‚Üí CSV
        // (—Å—Ç–∞—Ä–∞—è –ª–æ–≥–∏–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏)
    } else {
        // Batch ‚Üí Excel
        this.exportBatchToExcel();
    }
}
```

---

## üìä –û–∂–∏–¥–∞–µ–º—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

### –ö–∞—á–µ—Å—Ç–≤–æ —Ä–µ–∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏

| –ú–µ—Ç–æ–¥ | –ë—ã–ª–æ (score) | –û–∂–∏–¥–∞–µ—Ç—Å—è | –£–ª—É—á—à–µ–Ω–∏–µ |
|-------|--------------|-----------|-----------|
| Inpainting | 0.7884 | ~0.80 | +1.5% |
| CNN | 0.1051 | ~0.12 | +14% |
| GAN | 0.2661 | ~0.30 | +13% |
| **Hybrid** | **0.9661** | **~0.97+** | **+0.4%** |

**–ü–æ—á–µ–º—É Hybrid —É–ª—É—á—à–∏—Ç—Å—è –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ:**
- –ë–æ–ª—å—à–µ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è PCA (–ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 50 —Ñ–æ—Ç–æ)
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ blending (70/30)
- –°–≥–ª–∞–∂–µ–Ω–Ω–∞—è –º–∞—Å–∫–∞ –¥–ª—è –ª—É—á—à–∏—Ö –ø–µ—Ä–µ—Ö–æ–¥–æ–≤

---

## üöÄ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### 1. –ó–∞–ø—É—Å–∫ batch –æ–±—Ä–∞–±–æ—Ç–∫–∏

1. –ó–∞–≥—Ä—É–∑–∏—Ç–µ 10000 —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π
2. –ù–∞–∂–º–∏—Ç–µ Play (‚ñ∂Ô∏è)
3. –ù–∞–±–ª—é–¥–∞–π—Ç–µ –∑–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º

### 2. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è

–í –ª–æ–≥–∞—Ö backend –≤—ã —É–≤–∏–¥–∏—Ç–µ:

```
Auto-retraining PCA model after 50 images...
Auto-retraining PCA model after 100 images...
Auto-retraining PCA model after 150 images...
...
```

### 3. –≠–∫—Å–ø–æ—Ä—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ Excel

1. –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è batch –æ–±—Ä–∞–±–æ—Ç–∫–∏
2. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É **Export**
3. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∫–∞—á–∞–µ—Ç—Å—è —Ñ–∞–π–ª `batch_results_YYYY-MM-DD-HH-MM-SS.xlsx`

### 4. –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ Excel

–û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª –≤ Excel/LibreOffice –∏:

1. **–°–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –ø–æ Hybrid_Score** - –Ω–∞–π–¥–∏—Ç–µ –ª—É—á—à–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
2. **–§–∏–ª—å—Ç—Ä—É–π—Ç–µ –ø–æ Status** - –Ω–∞–π–¥–∏—Ç–µ –ø—Ä–æ–±–ª–µ–º–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
3. **–í—ã—á–∏—Å–ª–∏—Ç–µ —Å—Ä–µ–¥–Ω–∏–µ** - –æ—Ü–µ–Ω–∏—Ç–µ –æ–±—â–µ–µ –∫–∞—á–µ—Å—Ç–≤–æ
4. **–°–æ–∑–¥–∞–π—Ç–µ –≥—Ä–∞—Ñ–∏–∫–∏** - –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ –¥–∏–Ω–∞–º–∏–∫—É

**–ü—Ä–∏–º–µ—Ä —Ñ–æ—Ä–º—É–ª Excel**:

```excel
# –°—Ä–µ–¥–Ω–∏–π Hybrid Score
=AVERAGE(V2:V10001)

# –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—Å–ø–µ—à–Ω—ã—Ö Hybrid
=COUNTIF(U2:U10001,"completed")

# –ü—Ä–æ—Ü–µ–Ω—Ç —É—Å–ø–µ—à–Ω—ã—Ö
=COUNTIF(U2:U10001,"completed")/COUNTA(U2:U10001)*100
```

---

## üìù –ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### Backend:
1. `/root/site-img/backend/ai_service.py`
   - –£–≤–µ–ª–∏—á–µ–Ω—ã PCA –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (50 ‚Üí 100)
   - –î–æ–±–∞–≤–ª–µ–Ω–æ –∞–≤—Ç–æ–ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 50 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
   - –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω Hybrid –º–µ—Ç–æ–¥ (70/30 blending + —Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏–µ)

### Frontend:
1. `/root/site-img/src/app/simulation.service.ts`
   - –î–æ–±–∞–≤–ª–µ–Ω –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å `BatchResult`
   - –î–æ–±–∞–≤–ª–µ–Ω–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ `batchResults[]`
   - –î–æ–±–∞–≤–ª–µ–Ω—ã –º–µ—Ç–æ–¥—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è batch
   - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω —ç–∫—Å–ø–æ—Ä—Ç –≤ Excel —Å xlsx

2. `/root/site-img/src/app/dashboard/dashboard.component.ts`
   - –î–æ–±–∞–≤–ª–µ–Ω –≤—ã–∑–æ–≤ `clearBatchResults()`
   - –î–æ–±–∞–≤–ª–µ–Ω –≤—ã–∑–æ–≤ `setCurrentImageIndex()`

3. `/root/site-img/package.json`
   - –î–æ–±–∞–≤–ª–µ–Ω–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å `xlsx`

---

## üéØ –í—ã–≤–æ–¥

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ PCA –¥–ª—è –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–≥–æ —É–ª—É—á—à–µ–Ω–∏—è  
‚úÖ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è Hybrid –º–µ—Ç–æ–¥–∞ –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ score  
‚úÖ –≠–∫—Å–ø–æ—Ä—Ç –≤—Å–µ—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ Excel —Å –ø–æ–ª–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏  
‚úÖ –û—Ç–¥–µ–ª—å–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ –¥–ª—è –∫–∞–∂–¥–æ–π —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ —Å–æ –≤—Å–µ–º–∏ —ç—Ç–∞–ø–∞–º–∏  

**–û–∂–∏–¥–∞–µ–º—ã–π —ç—Ñ—Ñ–µ–∫—Ç:**
- Hybrid –º–µ—Ç–æ–¥ –±—É–¥–µ—Ç –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å **0.97+** score (—Å–µ–π—á–∞—Å 0.9661)
- –ö–∞—á–µ—Å—Ç–≤–æ –±—É–¥–µ—Ç **—É–ª—É—á—à–∞—Ç—å—Å—è** –ø–æ –º–µ—Ä–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –±–æ–ª—å—à–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ñ–æ—Ç–æ
- –ü–æ–ª–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ —É–¥–æ–±–Ω–æ–º Excel —Ñ–æ—Ä–º–∞—Ç–µ

**–ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!** üéâ
